---
abbrlink: '0'
---
# 实践要点

## 重点技术使用：

### redis使用
作为首次应用Redis的项目，项目团队对Redis的特性与可靠性缺乏实践经验，因此使用原则为仅作为高速辅助缓存，加速业务处理过程；但业务处理过程中不能完全依赖Redis提供的缓存服务，当Redis缓存失效时，应有其他方法来获取正确的数据，并重建缓存，继续业务处理，以保证业务处理的可靠性。
Redis的maxmemory-policy设置为volatile-lru模式。
按照如下步骤添加/修改缓存：
1.	若缓存中有数据，则先删除缓存。如果删除缓存失败，则操作视为失败。
2.	添加/修改数据库数据。如果修改失败，则操作视为失败。
3.	添加/修改缓存。如果添加/修改失败则操作整体视为成功，但系统应立即报警。

按照如下步骤读取缓存：
1.	若缓存中有数据，则直接读取缓存数据。
2.	若缓存没有数据，则从数据库中读取，读取完成后再将数据添加至缓存中。如果添加缓存失败系统应立即报警。

### 后台接口通讯
#### 方式
##### 交易类接口
	对于交易类接口，国彩通平台作为服务端提供一个URL，用以接收福彩账务系统发送的业务受理申请请求包，接收验签后即回复响应，表示成功接收业务受理申请请求包；福彩账务系统作为服务端提供一个URL，用以接收国彩通平台发送的业务受理结果通知请求包，接收验签后即回复响应，表示成功接收业务受理通知请求包。
	同一交易类接口拆分为一对业务受理申请包与业务受理结果通知包，它们之间以业务发起方设置的订单号作为关联，即同一接口的业务受理申请包与业务受理结果通知包的订单号相同。福彩账务系统可以并发的发送多个业务受理申请，国彩通平台可以并发的发送多个业务受理结果通知。
	国彩通平台发送业务受理结果通知包时，应设置超时参数（通常设置为10s），福彩账务系统在收到业务受理结果通知包后，解析验签后立即返回应答报文。仅当POST返回码为200时，才认为福彩账务系统已经成功收到并且能正确解析后台通知，其他返回码则被认为通知失败。如果超时，没有收到应答报文，也被认为通知失败。第一次通知失败后，国彩通平台会通过退避策略进行通知重发，最多发送五次。业务受理结果通知包发送失败时不会冲正原交易。福彩账务系统在未收到国彩通平台的业务受理结果通知包的情况下，需要主动发起交易查询类业务来查询交易状态。

##### 查询类接口
	对于查询类接口，国彩通平台作为服务端提供一个URL，用以接收福彩账务系统发送的查询请求包，接收验签后进行业务处理，并把查询结果响应给福彩账务系统。

#### 签名机制
	福彩账务系统与国彩通平台分别提供一个自己设定的私钥（由字母数字组成的16位字符串（字母大小写敏感））给对方，用于参与请求包与响应包的签名与验签。
	福彩账务系统请求包时使用国彩通提供的私钥进行签名，国彩通平台接收到请求包时使用国彩通提供的私钥进行验签；国彩通平台发送请求包与回复响应包时使用福彩提供的私钥进行签名，福彩账务系统接收到请求包与回复响应包时使用福彩提供的私钥进行验签。

​	
应用场景	MongoDB 海量数据的访问效率提升	Redis 较小数据量的性能和运算	MongoDB优于Redis



ProjectA项目后台管理系统
技术体系
后台管理系统采用JEE技术体系，基于vasoss4.0平台，使用Spring管理业务对象，结合通用日志框架、定时调度框架等实现业务对象管理与业务处理。
界面设计上，采用JSP、CSS和Javascript。所有Web界面实现必须兼容IE、FireFox等主流浏览器，不能使用浏览器专有特性。
WebAgent使用Struts2框架开发表现层，结合Spring Security3实现通用后台管理系统。
消息总线使用OpenJMS。
数据持久层采用JPA（hibernate实现），结合使用Spring声明式事务。
Agent与Server均支持集群环境。

后台管理系统中的权限管理参考了RBAC（Role-Based Access Control，基于角色的访问控制）中的RBAC0模型，同时结合开源的安全框架（如Spring Security3）的特性，将权限验证的重心转移到对功能资源地址（即功能URL）的访问控制上来。

中彩中心商业积分购彩平台————财运无限
系统实现基于J2EE技术，使用Vasoss4.0平台，使用Spring管理业务对象，结合通用日志框架、定时调度框架等实现业务对象管理与业务处理。
界面设计上，采用JSP、CSS和Javascript。所有Web界面实现必须兼容IE、FireFox等主流浏览器，不能使用浏览器专有特性。
WebAgent使用Struts2框架开发表现层。
移动应用接入使用servlet开发。
消息总线使用OpenJMS。
数据持久层采用JPA（hibernate实现）。通用权限管理持久层采用hibernate。
Agent与Server均支持集群环境。
数据库采用PostgreSQL。
对于APP服务端开发自测，可以使用发包工具（如Fiddler等）或http请求、响应模拟器（http://192.168.80.63:8888/simulator/）。

消息中心
技术路线
系统实现基于J2EE技术，使用Vasoss4.0平台。
消息总线使用OpenJMS。
Server使用Vasoss4.0 Server平台。
数据持久层采用JPA（Hibernate实现）。
数据库采用PostgreSQL。

汇拾网-群组子系统
技术路线
系统实现基于J2EE技术，使用Vasoss4.0平台，使用Spring管理业务对象，结合通用日志框架、定时调度框架等实现业务对象管理与业务处理。
界面设计上，采用JSP、CSS和Javascript。所有Web界面实现必须兼容IE、FireFox等主流浏览器，不能使用浏览器专有特性。
WebAgent使用Struts2框架开发表现层。
消息总线使用OpenJMS。
数据持久层采用JPA（hibernate实现）。
Agent与Server均支持集群环境。
数据库采用PostgreSQL。

描述汇拾网-帮助中心系统

1. 总体设计
   技术路线
   系统实现基于J2EE技术，使用Vasoss4.0平台，使用Spring管理业务对象，结合通用日志框架、定时调度框架等实现业务对象管理与业务处理。
   界面设计上，采用JSP、CSS和Javascript。所有Web界面实现必须兼容IE、FireFox等主流浏览器，不能使用浏览器专有特性。
   WebAgent使用Struts2框架开发表现层。
   消息总线使用OpenJMS。
   数据持久层采用JPA（hibernate实现）。
   Agent与Server均支持集群环境。
   数据库采用PostgreSQL。

1.1.	编写目的
?	本文档详细描述了Red5 Server开发框架的概要设计，开发人员在开发框架时应以本文档为主要依据和实现准则。
?	

```
《IW-VASOSS-PV4.0-服务器数据推送技术预研报告-V0.2》
```

1. 概述
   本文档对Red5开发框架的实现做了详细的介绍，旨在提供丰富便捷的接口，为开发人员提供以下便捷特性：
2. 无需关注长链接、会话的管理，并封装了Java的Socket和NIO，无需关注底层通讯的实现，以避免因socket而带来的线程、性能、会话等问题
3. 无需关注通讯时使用的协议，面向开发人员以一种全双工式的RPC远程调用
4. 提供自定义应用逻辑处理组件，并配合服务权限控制，实现向各房间开放指定服务。
5. 集成Vasoss 4.0，以各消息总线发送信息，并实现基于http协议的通讯技术。
   从而专注于应用逻辑的实现或与外部通讯
   2.1.	运行环境要求
   服务端：
   JDK	1.6
   Red5 Server 1.0.0 RC2
   客户端：
   客户端运行时环境包括两种：AIR运行时环境和Flash Player运行时环境，前者内置了后者，即AIR运行时环境提供了Flash Player运行时环境的所有功能。
   AIR运行时环境直接运行于操作系统之上，它主要适用于发布成桌面应用的情况；而Flash Player运行时环境运行于浏览器中，即作为浏览器的插件，它主要适用于发布成Web应用的情况。
   运行环境理论上只要支持NetConnection对象，或支持rtmp协议的socket连接对象即可，从Air 1.0、Flash player 9起便支持NetConnection对象。
   2.2.	目标
   在Red5 Server基础上，可开发应用并部署，Red5 Framework的目的是实现传统的socket通讯，并结合公司整体技术体系、符合汇拾网应用（游戏）的需求及特性，并结合Spring开发一框架，目的是使开发人员无需了解tcp/ip、socket、及通讯协议，像Spring一样支持插拔式服务配置，提供丰富方便的API构建应用。
   2.3.	预研总结
   通过对Red5进行预研，以下是对Red5提供的特性进行总结，并应用到开发框架中
6. 集成Apache Mina：封装了Java的Socket和NIO，解决了因socket而带来的线程、性能、会话等问题
7. RTMP协议：应用协议采用RTMP，在客户端、服务器均有实现，不需我们考虑协议的解析。在RTMP协议中，承载了即将调用客户端方法的信息，客户端解析后便自动执行，实现全双工RPC调用。
8. 作用域：Red5引入作用域概念，可以形象的描述为大厅、房间（房间内可以再建房间），并且作用域（房间）的创建与销毁由Red5管理，也提供接口由我们自己控制，为我们将来多人实时在线应用提供了基础的实现手段。
9. 集成Spring：Red5集成Spring 3.1来管理自身的服务，并提供了Spring配置文件的入口，为扩展自制定服务提供了重要实现手段。
10. 扩展逻辑处理器实现：在Red5上不需继承或实现任何接口，可随意扩展我们的客户端请求处理器，并在Red5适配器中，可配置这些处理器的权限，即向指定作用域（房间）提供服务
    2.4.	定义
    ?	Red5 Server：与FMS类似，提供基于Flash的流媒体服务的一款基于Java的开源流媒体服务器。它由Java语言编写，使用RTMP作为流媒体传输协议。
    ?	Red5 Framework：基于Red5 Server开发的小框架，结合实际需求实现了会话管理、连接管理、多种通讯方式。



IGS平台Connector总体设计，供开发实现人员参考。
1.2.	背景
IGS有EJB平台迁移到Vasoss平台，Server层和Agent层的架构调整较大，本文介绍Agent层的总体技术策略和技术方案。
2.2.	通讯协议
游戏界面基于Adobe Flex技术实现，与接入层通讯包含三种协议：
1、	Http Post：基于标准Http Post协议
2、	AMF：Adobe公司推出的，基于Http的二进制流协议。
3、	RTMP:实时消息传送协议，用于向游戏界面推送信息。

1. 基于HTTP Post的接入层结构设计
   3.1.	技术体系
   基于Http Post的接入层总体上采用JEE技术，主要技术有Servlet、JAXB、Spring MVC、Hazelcast等。
2. 基于AMF的接入层结构设计
   4.1.	技术体系
   基于AMF的接入层总体上采用JEE技术，主要技术有Servlet、BlazeDS。
   Blazeds服务就是一个包含J2EE Web应用程序的应用。Flex客户端通过通道发送请求到Blazeds服务的端点上。从端点开始，请求经过一系列的Java对象包括消息传播对象、服务对象、目标对象以及最终的适配器对象。适配器将请求实现为本地的、或者contacting a backend system或者远程服务例如JMS服务。
   在IGS Connector中，使用AMFEndpoing接收、分发请求信息，通过MessageBroker调用RemoteService处理请求；请求的处理对象为普通的Java类。
3. RTMP接入层结构设计
   5.1.	技术体系
   RTMP是Real Time Messaging Protocol（实时消息传输协议）的首字母缩写。该协议基于TCP，是一个协议簇，包括RTMP基本协议及RTMPT/RTMPS/RTMPE等多种变种。RTMP是一种设计用来进行实时数据通信的网络协议，主要用来在Flash/AIR平台和支持RTMP协议的流媒体/交互服务器之间进行音视频和数据通信。支持该协议的软件包括Adobe Media Server/Ultrant Media Server/Red5等。
   Red5提供基于Flash的流媒体服务的一款基于Java的开源流媒体服务器。它由Java语言编写，使用RTMP作为流媒体传输协议。
   5.2.	主要组件结构
   详见《IW-VASOSS-PV4.0-Red5服务器推送开发框架-概要设计V0.1.doc》。

IGS平台Server总体设计，供开发实现以及测试人员参考。
1.2.	背景
IGS由EJB平台迁移到Vasoss平台，Server层和Agent层的架构调整较大，本文介绍Server层的总体技术策略和技术方案。
2.2.	技术体系
IGS采用JEE技术体系，基于Vasoss4.0平台上，综合使用JEE核心规范和业界常用开源服务器、开源框架，实现系统功能。系统使用的主要技术有：
1、	Java 1.6及以上，JEE。
2、	JMS：Java消息服务规范。
3、	JPA：Java持久化规范。
4、	Vasoss4.0：英泰伟业分布式增值服务平台。
5、	Open JMS：基于Java的消息服务器。
6、	Spring：基于Java的开源运行时对象容器，支持对象依赖、AOP(声明式事务)。
7、	Hazelcast:基于Java的分布式Map、List、Lock工具。

九宫格游戏
九宫格游戏服务端采用JEE技术，多层分布式架构，由外到内分为以下几个层次：
1、	接入层：
Connector：实时业务接入服务器，负责接入九宫格游戏的请求。
2、	数据总线层
数据总线采用满足JMS规范的标准消息服务器构建。
MQ：JSM消息服务器
3、	业务处理层
Server：业务处理层，实时处理九宫格游戏的业务请求。
FM:提供随机数生成服务
4、	数据持久层
数据持久层使用关系数据库。
DB:PostgreSQL 9.1
5、	外部系统
外部系统仅有汇拾网API。

福彩网

福彩会员服务系统

投注站客户端







回答好下面3个问题：
1、请用5分钟的时间介绍一下自己
您好（大家好），我的姓名叫张波，来自于陕西西安，09年毕业，学历大专，我的经历比较简单。。毕业后主要从事网站方面的工作两年，教育软件开发方面的工作一年，听说贵公司招聘Java，我觉得我是比较合适的人选。所以来应聘”

Good morning. It's a pleasure for me present myself. My name is Bobit, and I am a candidate for the position of java software engineer I am certain that my qualification and experience is at par with the job requirement.

2、请说明你为什么会来应聘这个岗位？（凭什么来应聘这个岗位）

3、请说明如果公司录用了你，你打算在这个岗位上为公司创造哪些价值？

注意：应聘中多举事例，少说空话。尽量多说话，不要冷场。

Ajax 并不是一个新技术，它其实是整合了XMLHttpRequest、JavaScript、DOM、CSS、XML等众多技术，它采用XMLHttpRequest对象进行数据的异步交互，使用JavaScript增强用户体验、使用DOM组织内容、使用CSS显示外观、使用XML封装数据。
Ajax代码凌乱，难于维护，应运而生了Ext、DOJO、DWR、Prototype、GWT、Buffalo等框架。
DWR的英文全称是Direct Web Remoting,它是一个Web远程调用框架，通过dwr可以在客户端利用JavaScript直接调用服务器端的Java方法并返回值给JavaScript，就好像在服务器端直接调用Java代码一样。
DWR主要包括两个部分：
1、有一个Servlet在服务器上运行，用来处理请求并把结果返回浏览器。
2、有一些JavaScript在浏览器上运行，可以发送请求并动态改变页面。

Servlet的生命周期包括加载、实例化、初始化、处理客户端请求及移除，这个生命周期由javax.servlet.Servlet接口的init、service和destroy方法来实现，由部署Servlet的容器来控制。

事务的特性分别有：原子性(Atomicity)、一致性(Consistency)、隔离性(Isolation)、和持久性(Durabilily)。
JDBC 技术应用：手动编写数据库连接池。
对大型网站来说，频繁地进行数据库的连接操作，势必占用很多的系统资源，建立连接是个费时的过程，所以数据库连接池的核心就连接复用，减少连接的建立。
如何编写数据库连接池：
1、建立缓冲池
2、缓冲池建立好后，用户即可以从缓冲池中获取已经建立好的连接
3、当用户使用完这个连接后，即可返回给缓冲池
4、需要注意的是，数据库连接池必须实现单例模式，以保证连接池的唯一性。

